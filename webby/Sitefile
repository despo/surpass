require "gorgyrella"
require "surpass"

task :screenshots do
  require "tasks/screenshots"
end

task :default => :pdf

task :rsync => [:pdf] do
  system "rsync -v -r --delete --exclude-from=rsync-exclude output/ ananelson@rubyforge.org:/var/www/gforge-projects/surpass/"
end

task :generate_source do
  `rm -r content/source`
  `mkdir content/source`
  `ls ../lib/*.rb`.chomp.split.each do |n|
    File.open("content/source/#{File.basename(n, '.rb')}.txt", "w") do |f|
      f.write %{---
title:  #{File.basename(n)}
layout:  web
filter:
  - erb
---
<%= gorg("/Users/ana/work/surpass/lib/#{File.basename(n)}") %>
}
    end
  end
end

def manual_filename
  "surpass-manual-#{Surpass::VERSION.gsub(".", "-")}.pdf"
end

def gzipped_source
  bzr_version = `bzr revno ..`.strip
  filename = "surpass-r#{bzr_version}.tgz"

  # Create gzipped file
  `bzr export output/#{filename} ..`

  filename
end
